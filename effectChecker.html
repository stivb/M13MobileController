<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <link rel="stylesheet" type="text/css" href = "css/effects.css"/>
<script src="js/effects.js"></script>
</head>
<body>
<div data-role="page" id="EffectChainPage">
    <div data-role="content" >
        <h1>Song Title</h1>
        <div class="ui-grid-c">
            <div class="ui-block-a"><a data-role="button" id="BtnFx1" class="btnFxChooser">Fx 1</a></div>
            <div class="ui-block-b"><a data-role="button" id="BtnFx2" class="btnFxChooser">Fx 2</a></div>
            <div class="ui-block-c"><a data-role="button" id="BtnFx3" class="btnFxChooser">Fx 3</a></div>
            <div class="ui-block-d"><a data-role="button" id="BtnFx4" class="btnFxChooser">Fx 4</a></div>
        </div><!-- /grid-c -->
        <span class="effectName" id="spanFx1">Effect 1</span>
        <div class="ui-grid-b effect" id="DivFx1">

            <div class="ui-block-a param" >
                <span class="paramName">Param 1</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-b param">
                <span class="paramName">Param 2</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-c param">
                <span class="paramName">Param 3</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-a param">
                <span class="paramName">Param 4</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-b param">
                <span class="paramName">Param 5</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-c param">
                <span class="paramName">Param 6</span>
                <div class="percentIndicator"></div>
            </div>
        </div>
        <span class="effectName" id="spanFx2">Effect 2</span>
        <div class="ui-grid-b effect" id="DivFx2">
            <div class="ui-block-a param">
                <span class="paramName">Param 1</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-b param">
                <span class="paramName">Param 2</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-c param">
                <span class="paramName">Param 3</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-a param">
                <span class="paramName">Param 4</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-b param">
                <span class="paramName">Param 5</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-c param">
                <span class="paramName">Param 6</span>
                <div class="percentIndicator"></div>
            </div>
        </div>
        <span class="effectName" id="spanFx3">Effect 3</span>
        <div class="ui-grid-b effect" id="DivFx3">
            <div class="ui-block-a param">
                <span class="paramName">Param 1</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-b param">
                <span class="paramName">Param 2</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-c param">
                <span class="paramName">Param 3</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-a param">
                <span class="paramName">Param 4</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-b param">
                <span class="paramName">Param 5</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-c param">
                <span class="paramName">Param 6</span>
                <div class="percentIndicator"></div>
            </div>
        </div>
        <span class="effectName" id="spanFx4">Effect 4</span>
        <div class="ui-grid-b effect" id="DivFx4">
            <div class="ui-block-a param">
                <span class="paramName">Param 1</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-b param">
                <span class="paramName">Param 2</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-c param">
                <span class="paramName">Param 3</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-a param">
                <span class="paramName">Param 4</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-b param">
                <span class="paramName">Param 5</span>
                <div class="percentIndicator"></div>
            </div>
            <div class="ui-block-c param">
                <span class="paramName">Param 6</span>
                <div class="percentIndicator"></div>
            </div>
        </div>
        <div data-role="popup" id="EffectChooserPage">

            <div class="ui-grid-d EffectChooser">

                <div class="ui-block-a">
                    <a class="effectGroupBtn" data-role="button">Fuzz</a>
                </div>
                <div class="ui-block-b">
                    <a class="effectGroupBtn" data-role="button">Delay</a>
                </div>
                <div class="ui-block-c">
                    <a class="effectGroupBtn" data-role="button">Filter</a>
                </div>
                <div class="ui-block-d">
                    <a class="effectGroupBtn" data-role="button">Modulation</a>
                </div>
                <div class="ui-block-e">
                    <a class="effectGroupBtn" data-role="button">Reverb</a>
                </div>
            </div>
            <ul id="effectList" data-role="listview" data-inset="true">
            </ul>

        </div>

        <div data-role="popup" id="EffectTweakerPage">
                <div class="ui-grid-b effect">
                    <div class="ui-block-a param etp">
                        <span class="paramName">Param 1</span>
                        <div class="percentIndicator"></div>
                    </div>
                    <div class="ui-block-b param etp">
                        <span class="paramName">Param 2</span>
                        <div class="percentIndicator"></div>
                    </div>
                    <div class="ui-block-c param etp">
                        <span class="paramName">Param 3</span>
                        <div class="percentIndicator"></div>
                    </div>
                    <div class="ui-block-a param etp">
                        <span class="paramName">Param 4</span>
                        <div class="percentIndicator"></div>
                    </div>
                    <div class="ui-block-b param etp">
                        <span class="paramName">Param 5</span>
                        <div class="percentIndicator"></div>
                    </div>
                    <div class="ui-block-c param etp">
                        <span class="paramName">Param 6</span>
                        <div class="percentIndicator"></div>
                    </div>
                </div>

                <div data-role="fieldcontain" id="slider1" class="slider etp">
                    <p> Param 1</p>
                    <label for="slider1-range"></label>
                    <input type="range" id="slider1-range" value="50" min="0" max="100" step="1"
                    />
                </div>
                <div data-role="fieldcontain" id="slider2" class="slider etp">
                    <p> Param 1</p>
                    <label for="slider2-range"></label>
                    <input type="range" id="slider2-range" value="50" min="0" max="100" step="1"
                    />
                </div>
                <div data-role="fieldcontain" id="slider3" class="slider etp">
                    <p> Param 1</p>
                    <label for="slider3-range"></label>
                    <input type="range" id="slider3-range" value="50" min="0" max="100" step="1"
                    />
                </div>
                <div data-role="fieldcontain" id="slider4" class="slider etp">
                    <p> Param 1</p>
                    <label for="slider4-range"></label>
                    <input type="range" id="slider4-range" value="50" min="0" max="100" step="1"
                    />
                </div>
                <div data-role="fieldcontain" id="slider5" class="slider etp ">
                    <p> Param 1</p>
                    <label for="slider5-range"></label>
                    <input type="range" id="slider5-range" value="50" min="0" max="100" step="1"
                    />
                </div>
                <div data-role="fieldcontain" id="slider6" class="slider etp">
                    <p> Param 1</p>
                    <label for="slider6-range"></label>
                    <input type="range" id="slider6-range" value="50" min="0" max="100" step="1"
                    />
                </div>

                <div class="ui-grid-a">
                    <div class="ui-block-a">
                        <a data-role="button" id="EffectTweakerPageOk">Ok</a>
                    </div>
                    <div class="ui-block-b">
                        <a data-role="button" id="EffectTweakerPageCancel">Cancel</a>
                    </div>
                </div>



        </div>
    </div>
</div>

<script>

    var fX = new Array({},{},{},{});
    var currEffectNum=-1;
    $( ".effectGroupBtn" ).click(function() {

        var filterGroup = $(this).text();
        var effectsToShow = allEffectNamesByGroup(filterGroup);
        var cList = $('#effectList');
        cList.empty();
        $.each(effectsToShow, function(i)
        {
            var li = $('<li/>').appendTo(cList);
            var aaa = $('<a/>').text(effectsToShow[i]).addClass("effectChoice").appendTo(li);
        });
        cList.listview( "refresh" );
    });

    $( ".btnFxChooser" ).click(function() {

        $( "#EffectChooserPage").popup();
        $( "#EffectChooserPage" ).popup( "open" );
        var id = $(this).attr("id");
        currEffectNum = id.slice(-1)*1;

    });

    $(".effect").click(function() {

        var id = $(this).attr("id");
        currEffectNum = id.slice(-1)*1;
        var currEffect = fX[currEffectNum-1] ;
        $( "#EffectTweakerPage").popup();
        $( "#EffectTweakerPage" ).popup( "open" );
        var paramNames = removeNonNumericFromArray(Object.keys(currEffect));
        $( ".etp").css("visibility", "hidden");
        $( "#EffectTweakerPage").css("background-color",currEffect.EffectColor);
        var sliders = $("#EffectTweakerPage").find(".slider");
        var labels =  $("#EffectTweakerPage").find(".paramName");
        var sliderHeaders = $("#EffectTweakerPage").find("p");
       // alert($(labels[0]).text());
        $.each(paramNames, function( index, value ) {
            $(labels[index]).text(paramNames[index]);
            $(labels[index]).parent().css("visibility","visible");
            $(sliderHeaders[index]).text(paramNames[index]);
            $(sliders[index]).css("visibility","visible");
        });

    });


    $('body').on('click', 'a.effectChoice', function() {
        var fxName = $(this).text();
        $( "#EffectChooserPage" ).popup( "close" );
        $("#spanFx" + currEffectNum).text(fxName );
        var currEffect = getEffect(fxName );
        fX[currEffectNum-1] = currEffect;
        var paramNames = removeNonNumericFromArray(Object.keys(currEffect));
        $( "#DivFx"+ currEffectNum ).children().css("visibility", "hidden");
        $( "#DivFx"+ currEffectNum ).css("background-color",currEffect.EffectColor);
        $( "#DivFx"+ currEffectNum ).find( ".paramName" ).each(function(index,elmt){

            if (paramNames.length>index)
            {
                $(this).text(paramNames[index]);
                $(this).parent().css("visibility","visible");
            }
        });

    });

    function visualizeFx(num)
    {

    }
</script>
</body>
</body>
</html>
